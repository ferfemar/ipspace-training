# Common debugging tasks when debug var is set

- name: get timestamp
  set_fact:
    timestamp: "{{ lookup('pipe','date +%d-%m-%Y-%H-%M-%S') }}"
  delegate_to: localhost
  run_once: true

- name: determine debug output dir
  set_fact:
    debug_output: "{{ printouts }}/debug-{{ timestamp }}"
  delegate_to: localhost
  run_once: true

- name: create debug dir 
  local_action: file path="{{ debug_output }}" state=directory
  delegate_to: localhost
  run_once: true
  when: debug is defined